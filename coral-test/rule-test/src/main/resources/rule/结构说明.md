# 【规则执行JSON文件】字段说明（列表）

    文件名固定：rule_execute.json

| 字段           | 类型   | 说明                                                                               |
|--------------|------|----------------------------------------------------------------------------------|
| desc         | 字符串  | 接口说明                                                                             |
| api_service  | 字符串  | 接口服务名，会最终拼接到规则数据报告名的末尾                                                           |
| url          | 字符串  | 接口地址，例如：http://192.168.29.119:9000/api/insurance/v1/qc/verify/evidenceBased      |
| api_key      | 字符串  | 接口关键字， 需要在同一【接口服务名】下唯一。例如：基础校验                                                   |
| method       | 字符串  | 请求方式，例如：POST                                                                     |
| content_type | 字符串  | 内容格式，例如：application/json                                                         |
| data         | JSON | 接口需要的入参，内部可以使用变量，例如：${hosp_code}，会自动去【规则测试JSON文件】、【表JSON文件】、【表字段映射JSON文件】中查找对应的值 |

------

# 【表JSON文件】说明（列表）

    文件格式：dwd.dwd_emr_consult_doctor.json 其中 `dwd.dwd_emr_consult_doctor.json` 为数据库中某表的全限定名称

文件内部内容为 随便选择一个患者的一条数据，然后导出为JSON格式，将导出的JSON数据复制过来，需要注意的是其中的时间格式需要修改为
2024-03-18 09:53:04 这种格式

-----

# 【表字段映射JSON文件】字段说明（列表）

    文件名格式：dwd.dwd_misl_diag_setting.json 其中`dwd.dwd_misl_diag`为数据库中某表的全限定名称，`_setting`为固定格式

【规则测试JSON文件】当`field_mappings/field_mapping`
字段映射的数据中有某个字段名和字段对应的值在【表字段映射JSON文件】中能匹配上的话，会自动将【表字段映射JSON文件】`field_mapping`
下配置的所有字段及其值同时插入/修改

| 字段            | 类型   | 说明                                                    |
|---------------|------|-------------------------------------------------------|
| field_value   | 字符串  | 字段名称对应的值                                              |
| field         | 字符串  | 字段名称对应的数据库字段名                                         |
| name          | 字符串  | 字段名称                                                  |
| field_mapping | JSON | 字段映射，数据库中哪个字段需要编辑数据，直接此处配置。该字段名称同时绑定的其他数据库字段名和字段名对应的值 |

# 【规则测试JSON文件】字段说明（JSON）

    文件名格式：QD0019601_C50.json 其中`QD0019601`为规则编码，`C50`为本条规则的简约说明

| 字段                       | 类型   | 说明                                                                                                       |
|--------------------------|------|----------------------------------------------------------------------------------------------------------|
| rule_code                | 字符串  | 规则编码                                                                                                     |
| rule_name                | 字符串  | 规则名称                                                                                                     |
| descs                    | 列表   | 测试说明，此处可填写详细测试步骤                                                                                         |
| expected_result          | 字符串  | 预期结果，能和最终的规则响应结果resultAdvice数据全部匹配上即认为和预期结果一致                                                            |
| expected_result_keywords | 列表   | 预期结果关键字列表，列表能和最终的规则响应结果resultAdvice数据全部匹配上即认为和预期结果一致                                                     |
| expected_result_items    | 列表   | 预期结果细项，能和最终的规则响应结果细项resultAdviceItems列表中的name对应即认为和预期结果一致                                                |
| unique_key               | 字符串  | 全局唯一键约束，后续的settings节点中的unique_key可以覆盖此处配置。值会自动生成，默认为uuid生成方式                                             |
| select_keys              | 列表   | 全局查询字段，构建测试数据的时候，会根据这几个字段先去数据库查询，查询到了的话会执行更新操作，查询不存在才会执行插入操作。对于患者的诊断之类的一对多的数据，必须要加上诊断记录的唯一primary_id来查询。 |
| required                 | JSON | 必须字段，这里放一些患者最基本的信息，又必须需要的                                                                                |
| optional                 | JSON | 可选字段,这里放一些患者最基本的信息，不是必须需要的                                                                               |
| settings                 | 列表   | 字段设置                                                                                                     |
| └ table                  | 字符串  | 表名，需要带上schema，列如：dwd.dwd_misl_main                                                                       |
| └ unique_key             | 字符串  | 表唯一键约束                                                                                                   |
| └ select_keys            | 列表   | 查询字段，构建测试数据的时候，会根据这几个字段先去数据库查询，查询到了的话会执行更新操作，查询不存在才会执行插入操作                                               |
| └ table                  | 字符串  | 表名，需要带上schema，列如：dwd.dwd_misl_main                                                                       |
| └ pre_sqls               | 字符串  | 执行数据库插入/修改之前需要执行的前置SQL语句。例如删除这个患者的所有数据。可以写变量，变量格式为${table}，此时会自动全文查找table字段具体值                           |
| └ post_sqls              | 字符串  | 执行数据库插入/修改之前需要执行的后置SQL语句。例如删除这个患者的所有数据。可以写变量，变量格式为${table}，此时会自动全文查找table字段具体值                           |
| └ field_mapping          | JSON | 字段映射，数据库中哪个字段需要编辑数据，直接此处配置。有需要的话也可以直接将数据库中真实数据以json格式导出来，然后复制到此处，这样即为修改数据库所有字段                           |
| └ field_mappings         | 列表   | 同field_mapping，只是可以配置多个                                                                                  |
